# AGENT.md - Project Rules & Architecture

このファイルは、この dotfiles プロジェクトを扱うすべての AI エージェントおよび開発者のためのガイドラインです。

## 1. プロジェクトの目的
*   **Mac と Windows (WSL)** で一貫した開発体験を提供する。
*   環境ごとの差異を吸収しつつ、メンテナンス性を最大化する。

## 2. パッケージ管理戦略 (Hybrid Strategy)
OSごとの役割分担を厳格に守ります。

| カテゴリ | ツール例 | 管理方法 | 理由 |
| :--- | :--- | :--- | :--- |
| **OS 基盤 / インフラ** | `zsh`, `git`, `curl`, `ssh`, `build-essential` | **OS標準 (APT)** | OSの安定性・セキュリティ・ネットワーク機能に直結するため。OS標準が最も安全。 |
| **開発ツール / アプリ** | `starship`, `bat`, `ripgrep`, `mise`, `gh` | **Homebrew** | 日々進化する機能を使いたいため。最新版の追従が容易。 |
| **迷った場合** | - | **OS標準 (APT)** | 安定性を優先する。 |

*   **Macの場合**: 原則すべて **Homebrew** で管理する。

## 3. ディレクトリ構成ルール

*   **`common/`**: OSに依存しない、または両方のOSで共有すべき設定。
    *   `Brewfile`: 共通のCLIツール (`bat`, `eza` など)
    *   `.zshrc`, `aliases.zsh`: シェルの共通設定
*   **`mac/`**: macOS 固有の設定。
    *   `Brewfile`: GUIアプリ (Cask) や Mac 固有ツール
*   **`wsl/`**: WSL/Ubuntu 固有の設定。
    *   `install_tools.sh`: APTパッケージの管理と Homebrew のセットアップ

## 4. 変更時の注意点
*   **冪等性 (Idempotency)**: インストールスクリプトは何度実行しても壊れないように作る（`apt install` や `brew bundle` はそのままでOKだが、設定ファイルの追記などは `grep` でチェックする）。
*   **クリーンアップ**: 新しい管理方法（例: Brew）に移行する場合、古い管理方法（例: apt/curl）でインストールされたものは削除または無効化する。

## 5. 言語設定
*   ドキュメント、コミットメッセージ、エージェントとの対話は **日本語** を使用する。
